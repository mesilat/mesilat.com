<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Using Mondrian with Confluence Fields - Mesilat Limited Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="44696055">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">PUB</span>
                    <img class="space-logo" src="PUB.png" />
                </h1>
                <a href="44696055.html" class="ht-space-link">
                    <h2>Mesilat Limited Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=51151194"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="44696055.html">Mesilat Limited Documentation</a></li>
                                                                                     <li><a href="44696004.html">Confluence Fields plugin for Atlassian JIRA</a></li>
                                                            </ul>
</div>            <h1 id="src-51151194"> <span>Using Mondrian with Confluence Fields</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>Confluence Fields plugin for Atlassian JIRA features an embedded Mondrian 4 server that could be used to perform OLAP analysis based on your JIRA worklog. You will need MS Excel for Windows and XMLA Connect for Excel (<a  class="external-link" href="https://sourceforge.net/projects/xmlaconnect/">download</a> from SourceForge). After you install the XMLA Connect use the connection wizard to connect your Excel to JIRA:</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_13.36.40.png" alt="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_13.36.40.png"   />
    </p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_13.37.29.png" alt="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_13.37.29.png"   />
    </p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_13.37.39.png" alt="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_13.37.39.png"   />
    </p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_13.40.42.png" alt="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_13.40.42.png"   />
    </p>
<p   
>The Connection properties should be set as follows:</p>
<p   
></p>
    <div  class="tablewrap">
        <table class="wrapped confluenceTable">
                    <colgroup>
                                    <col />
                                    <col />
                            </colgroup>
        <thead class=" ">    <tr>
            <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Property</p>
            </td>
                <td  class="confluenceTh" rowspan="1" colspan="1">
    <p   
>Description</p>
            </td>
        </tr>
</thead><tfoot class=" "></tfoot><tbody class=" ">    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Location</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>http://{JIRA_BASE_ADDRESS}/plugins/servlet/xmla</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>User name</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Your JIRA username</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Password</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Your JIRA password</p>
            </td>
        </tr>
    <tr>
            <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Catalog</p>
            </td>
                <td  class="confluenceTd" rowspan="1" colspan="1">
    <p   
>Select 'default'</p>
            </td>
        </tr>
</tbody>        </table>
            </div>
<p   
></p>
<p   
>If everything is correct then <i class=" ">Test Connection</i> should succeed and you will be able to proceed to <i class=" ">Select Database and Table</i> dialog. Choose <i class=" ">Worklog</i> and move on leaving all options by default until you finally get your worklog pivot in MS Excel.</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_13.48.29.png" alt="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_13.48.29.png"   />
    </p>
<p   
>Note your Confluence Field is available in the pivot (<i class=" ">Customer</i> in the screenshot below):</p>
    <div class="section section-1" id="src-51151194_UsingMondrianwithConfluenceFields-ConfluenceFieldOLAPTitle">
        <h1 class="heading "><span>Confluence Field OLAP Title</span></h1>
<p   
>JIRA supports national languages for custom field name but XMLA Connect does not. Thus if your field's name is 客户 then you need an option to specify an English synonym. Use <i class=" ">Dimension</i> property in the Confluence Field configuration page for that purpose. For more details please refer to <a   href="51151147.html">Confluence Field Configuration</a>.</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_14.04.21.png" alt="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_14.04.21.png"   />
    </p>
    </div>
    <div class="section section-1" id="src-51151194_UsingMondrianwithConfluenceFields-Troubleshooting">
        <h1 class="heading "><span>Troubleshooting</span></h1>
<p   
>The builtin Mondrian server uses its own URL classloader to load applicable driver JAR file from your <tt class=" ">${JIRA_INSTALLATION_HOME}/lib</tt> directory. Driver files are expected to have standard names:</p>
<ul class=" "><li class=" "><p   
>mysql*.jar (com.mysql.jdbc.Driver)</p>
</li><li class=" "><p   
>postgresql*.jar (org.postgresql.Driver)</p>
</li><li class=" "><p   
>ojdbc*.jar (oracle.jdbc.OracleDriver)</p>
</li><li class=" "><p   
>mssql*.jar (com.microsoft.sqlserver.jdbc.SQLServerDriver) or jtds*.jar (net.sourceforge.jtds.jdbc.Driver)</p>
</li></ul><p   
>If you driver file has a different name the plugin will not be able to locate and load it. In this case please use external Mondrian server as described below.</p>
    <div class="section section-2" id="src-51151194_UsingMondrianwithConfluenceFields-Logging">
        <h2 class="heading "><span>Logging</span></h2>
<p   
>XMLA Connect error messages are not very informative (to say the least). In case you get a connection error or your query fails then XMLA servlet logging could help to diagnose the problem. You can switch on logging at Confluence Fields plugin administration page:</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_14.10.40.png" alt="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_14.10.40.png"   />
    </p>
<p   
>This will set the     <span style="color: #172b4d;">
<strong class=" ">mondrian.xmla.XmlaServlet</strong> logger to DEBUG level. At DEBUG level you will be able to watch XMLA requests and the Mondrian server responses. For example:    </span>
</p>
<p   
>    <span style="color: #172b4d;">
<img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_14.33.07.png" alt="images/wiki/download/attachments/51151194/Screenshot_2020-11-21_at_14.33.07.png"   />
The actual error message is:    </span>
</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;</code><code class="keyword">XA</code><code class="plain">:error </code><code class="color1">xmlns:XA</code><code class="plain">=</code><code class="string">"http://mondrian.sourceforge.net"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">code</code><code class="plain">&gt;00HSBE02&lt;/</code><code class="keyword">code</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">desc</code><code class="plain">&gt;The Mondrian XML: In Schema: In PhysicalSchema: In Query: Attribute 'alias' is unset and has no default value.&lt;/</code><code class="keyword">desc</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">&lt;/</code><code class="keyword">XA</code><code class="plain">:error&gt;</code></div>
</div>
    </div>
<p   
>    <span style="color: #172b4d;">
This error means that you did not specify a <i class=" ">Dimension</i> property for your Confluence custom field:    </span>
</p>
    </div>
    </div>
    <div class="section section-1" id="src-51151194_UsingMondrianwithConfluenceFields-UsingwithExternalMondrianServer">
        <h1 class="heading "><span>Using with External Mondrian Server</span></h1>
<p   
>    <span style="color: #172b4d;">
As Mondrian server can be quite resource hungry you may choose not to use a built-in Mondrian server but to setup an external one.     </span>
    <span style="color: #172b4d;">
You can get a WAR-packaged Mondrian 4 server from Github: <a  class="external-link" href="https://github.com/mesilat/mondrian-jira/releases">https://github.com/mesilat/mondrian-jira/releases</a>.     </span>
    <span style="color: #172b4d;">
Please refer to the project's <a  class="external-link" href="https://github.com/mesilat/mondrian-jira/blob/master/README.md">README</a> if are planning to run your Mondrian server in docker.    </span>
</p>
<p   
>    <span style="color: #172b4d;">
Basically, to get your standalone Mondrian server running takes the following steps:    </span>
</p>
<ul class=" "><li class=" "><p   
>Install Apache Tomcat 9 or later</p>
</li><li class=" "><p   
>Download JDBC driver for your JIRA database and copy it to <tt class=" ">TOMCAT_HOME/lib</tt> directory</p>
</li><li class=" "><p   
>Edit the <tt class=" ">TOMCAT_HOME/lib/tomcat-users.xml</tt> file and add some users with <tt class=" ">xmla_user</tt> role; these are the credentials Excel will use to connect to your Mondrian server</p>
</li><li class=" "><p   
>Deploy the mondrian.war application</p>
</li><li class=" "><p   
>Download Mondrian schema file at JIRA Confluence Fields administration page and save it to Tomcat (<tt class=" ">TOMCAT_HOME/webapps/mondrian/WEB-INF/classes/schemas/default.xml</tt>)</p>
</li><li class=" "><p   
>Edit <tt class=" ">TOMCAT_HOME/webapps/mondrian/WEB-INF/classes/datasources.xml</tt> and update <tt class=" ">DataSourceInfo</tt> to match your JIRA database connection settings</p>
</li><li class=" "><p   
>Edit <tt class=" ">TOMCAT_HOME/webapps/mondrian/WEB-INF/classes/mondrian.properties</tt> if required. For details please refer to Mondrian <a  class="external-link" href="https://mondrian.pentaho.com/documentation/configuration.php">documentation</a></p>
</li></ul><p   
>Then restart your Tomcat server. Use <tt class=" ">http://{TOMCAT_ADDRESS}/mondrian/xmla</tt> for <i class=" ">Location</i> property in Excel XMLA Connect wizard.</p>
<p   
></p>
<p   
></p>
<p   
></p>
<p   
></p>
<p   
></p>
<p   
></p>
<p   
></p>
<p   
></p>
<p   
></p>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="51151192.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Using Substitution Variables</span>
        </a>
                <a href="51151209.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Using Confluence Fields with JIRA SD Customer Portal</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
