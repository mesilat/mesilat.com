<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Confluence Fields OLAP - Mesilat Limited Documentation</title>

    
    <link rel="stylesheet" href="assets/css/expand-macro.css">

            <meta name="scroll-content-language-key" content="">
    
    <meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=yes">

<script type="text/javascript" src="assets/js/jquery.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.scrollTo.min.js"></script>


<script type="text/javascript" src="assets/js/translate.js"></script>


<script type="text/javascript" src="assets/js/scroll-tree.js"></script>

<script type="text/javascript" src="assets/js/theme.main.js"></script>

    <script type="text/javascript" src="assets/js/iframeResizer.min.js"></script>

<link rel="stylesheet" href="assets/css/content-style.css">
    <link rel="stylesheet" href="assets/css/search.css">

<link rel="stylesheet" href="assets/css/theme.main.css">
<link rel="stylesheet" href="assets/css/theme.colors.css">

            <!-- ES5 support for older browsers, needed by lunr -->
        <script src="js/augment.js"></script>
        <script id="worker" type="javascript/worker">

        startIndex = function() {
            idx = lunr.Index.load(lunrIndex);
            idx.pipeline.remove(lunr.stopWordFilter);
            postMessage({type: "setup-complete"});
        }

        onmessage = function (event) {
            var message = event.data;

            if ((message.type === 'setup') && message.baseUrl) {
                var url = message.baseUrl;
                importScripts(url + 'js/lunr.js');
                importScripts(url + 'js/lunr-extras.js');
                importScripts(url + 'js/lunr-index.js');
                importScripts(url + 'js/lunr-data.js');
                startIndex();
            }

            if (idx && (message.type === 'search-request') && message.query) {
                var searchWord = message.query;
                var results = idx.search(searchWord).map(function (result) {
                    return lunrData.filter(function (d) {
                        return d.id === parseInt(result.ref, 10)
                    })[0]
                });
                postMessage({type: 'search-results', results: results, query: searchWord, queryId: message.queryId});
            }
        }

    </script>
    </head>

<body pageid="44696055">

<div id="ht-loader">
    <noscript>
        <p style="width: 100%; text-align:center; position: absolute; margin-top: 200px;">This content cannot be displayed without JavaScript.<br>Please enable JavaScript and reload the page.</p>
    </noscript>
</div>

<div>
   	<header id="ht-headerbar">
    <div class="ht-headerbar-left">
        <a href="" id="ht-menu-toggle" class="sp-aui-icon-small sp-aui-iconfont-appswitcher"></a>
    </div>
    <div class="ht-headerbar-right">
            <div class="sp-aui-icon-small ht-search-index-loader ht-header-icon"></div>

        <div id="ht-search">
            <div class="ht-search-input" style="display: none;">
              	<a href="#" class="sp-aui-icon-small sp-aui-iconfont-remove ht-search-clear"></a>

                <form action="#" method="GET" id="search">
                    <input class="search-input" type="text" placeholder="Search" tabindex="-1" autocomplete="off" name="q" value="">
                    <input type="hidden" name="max" value="15" />
                    <input type="submit" style="display:none" tabindex="-4"/>
                </form>

                <a href="#" id="ht-search-button" class="ht-header-icon ht-header-icon-svg">
                                        <svg width="40px" height="40px" viewBox="0 0 40 40" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <g>
                            <path d="M29.572,28.802 L28.801,29.571 C28.515,29.857 28.187,30 27.816,30 C27.445,30 27.116,29.857 26.831,29.571 L21.392,24.134 C20.193,24.762 18.908,25.076 17.538,25.076 C15.396,25.076 13.605,24.348 12.163,22.892 C10.721,21.436 10,19.651 10,17.538 C10,15.397 10.721,13.605 12.163,12.163 C13.605,10.721 15.396,10 17.538,10 C19.651,10 21.434,10.721 22.89,12.163 C24.347,13.605 25.075,15.397 25.075,17.538 C25.075,18.937 24.761,20.222 24.132,21.393 L29.572,26.832 C29.857,27.118 30,27.446 30,27.817 C30,28.188 29.857,28.517 29.572,28.802 L29.572,28.802 Z M13.662,21.414 C14.732,22.485 16.024,23.02 17.538,23.02 C19.051,23.02 20.343,22.485 21.413,21.414 C22.484,20.344 23.019,19.052 23.019,17.538 C23.019,16.025 22.484,14.733 21.413,13.662 C20.343,12.592 19.051,12.056 17.538,12.056 C16.024,12.056 14.732,12.592 13.662,13.662 C12.591,14.733 12.056,16.025 12.056,17.538 C12.056,19.052 12.591,20.344 13.662,21.414 L13.662,21.414 Z"></path>
                        </g>
                    </svg>
              	</a>

                <div class="ht-search-dropdown ht-dropdown">
                    <ul></ul>
                </div>
            </div>
        </div>
    </div>
    </header>   	<aside id="ht-sidebar">
    <div class="ht-sidebar-content">
        <div class="ht-sidebar-content-scroll-container">
            <header class="ht-sidebar-header">
                <h1 class="ht-logo">
                    <span class="ht-logo-label">PUB</span>
                    <img class="space-logo" src="PUB.png" />
                </h1>
                <a href="44696055.html" class="ht-space-link">
                    <h2>Mesilat Limited Documentation</h2>
                </a>
            </header>
                            <iframe id="ht-nav" src="toc.html?pageId=58753059"></iframe>
                <script>
                    $('iframe#ht-nav').iFrameResize(
                            { 'log': true, 'autoResize': true, 'heightCalculationMethod': 'lowestElement', 'checkOrigin': false });
                </script>
                    </div>
    </div>

</aside></div>

<div id="ht-wrap-container">

            
    <div id="ht-sidebar-dragbar">
    <div class="ht-sidebar-drag-handle">
        <span class="drag-handle-1"></span>
        <span class="drag-handle-2"></span>
        <span class="drag-handle-3"></span>
    </div>
</div>
    <article id="ht-content" class="ht-content">
        <header class="ht-content-header">
            <div id="ht-breadcrumb">
    <ul>
        <li><a href="44696055.html">Mesilat Limited Documentation</a></li>
                                                                                     <li><a href="44696004.html">Confluence Fields plugin for Atlassian JIRA</a></li>
                                                            </ul>
</div>            <h1 id="src-58753059"> <span>Confluence Fields OLAP</span></h1>
        </header>

        <div id="main-content" class="wiki-content sp-grid-section" data-index-for-search="true">

<p   
>Suppose I have set up Confluence Fields to take my company's clients from Confluence pages. A single Jira issue can be shared by several clients and work can be logged by several workers. So how do I know how much time was spent on a particular client by a particular worker? Or how do I get an aggregate of all work logged for a particular client? Or all clients? To answer this questions I need OLAP.</p>
<p   
>For example, I have an issue with some clients and some work logged:</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-12.00.36.png" alt="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-12.00.36.png"   />
then I would like to be able to aggregate it as follows:</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-12.04.17.png" alt="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-12.04.17.png"   />
Confluence Fields plugin can help.</p>
    <div class="section section-1" id="src-58753059_ConfluenceFieldsOLAP-ConfluenceFieldsOLAP">
        <h1 class="heading "><span>Confluence Fields OLAP</span></h1>
<p   
>Confluence Fields provides OLAP for Jira. It publishes Jira worklog to <a  class="external-link" href="https://clickhouse.tech/docs/en/">ClickHouse</a> database. ClickHouse powers <a  class="external-link" href="https://mondrian.pentaho.com/documentation">Mondrian server</a> while <a  class="external-link" href="https://en.wikipedia.org/wiki/Microsoft_Excel">MS Excel</a> is used to run queries and create pivots, charts, reports etc. Overall information flow is <strong class=" ">Jira</strong> &rarr; <strong class=" ">ClickHouse</strong> &rarr; <strong class=" ">Mondrian</strong> &rarr; <strong class=" ">Excel</strong>. This setup may seem too complex at first glance but it is worth it: ClickHouse outperforms Postgres or MySQL as analytical backend by orders of magnitude in my tests.</p>
<p   
>Confluence Fields OLAP is switched off by default. Your Jira system administrator can enable it by turning on the plugin's <strong class=" ">OLAP</strong> module:</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-10.38.11.png" alt="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-10.38.11.png"   />
    <br/>Jira administrator configures ClickHouse endpoint and Confluence fields:</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-10.36.png" alt="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-10.36.png"   />
    </p>
<p   
>Jira project admin may choose to switch off OLAP for a particular project:</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-11.40.09.png" alt="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-11.40.09.png"   />
    </p>
    </div>
    <div class="section section-1" id="src-58753059_ConfluenceFieldsOLAP-ClickHouse">
        <h1 class="heading "><span>ClickHouse</span></h1>
<p   
>ClickHouse is a very powerful database for analytics.</p>
<p   
>The easiest way to run ClickHouse is to use the <a  class="external-link" href="https://hub.docker.com/r/yandex/clickhouse-server/">docker image</a>. If you use <strong class=" ">docker-compose</strong> your clickhouse service definition can be as follows:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">clickhouse:</code></div>
<div class="line"><code class="plain">  restart: unless-stopped</code></div>
<div class="line"><code class="plain">  image: yandex/clickhouse-server</code></div>
<div class="line"><code class="plain">  container_name: clickhouse</code></div>
<div class="line"><code class="plain">  network_mode: host</code></div>
<div class="line"><code class="plain">  ulimits:</code></div>
<div class="line"><code class="plain">    nofile:</code></div>
<div class="line"><code class="plain">      soft: </code><code class="string">"262144"</code></div>
<div class="line"><code class="plain">      hard: </code><code class="string">"262144"</code></div>
<div class="line"><code class="plain">  volumes:</code></div>
<div class="line"><code class="plain">    - /var/docker/demo/clickhouse:/var/lib/clickhouse</code></div>
</div>
    </div>
<p   
>ClickHouse uses port 8123 for HTTP connections by default.</p>
<p   
>Confluence Fields creates <strong class=" ">jira_worklog</strong> table in ClickHouse database:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">create</code><code class="plain"> </code><code class="keyword">table</code><code class="plain"> jira_worklog (</code></div>
<div class="line"><code class="plain">  id UInt64,</code></div>
<div class="line"><code class="plain">  project_id UInt64,</code></div>
<div class="line"><code class="plain">  project_key LowCardinality(String),</code></div>
<div class="line"><code class="plain">  issue_id UInt64,</code></div>
<div class="line"><code class="plain">  issue_key LowCardinality(String),</code></div>
<div class="line"><code class="plain">  worklog_id UInt64,</code></div>
<div class="line"><code class="plain">  started </code><code class="keyword">Date</code><code class="plain">,</code></div>
<div class="line"><code class="plain">  timespent Float64,</code></div>
<div class="line"><code class="plain">  worker LowCardinality(String),</code></div>
<div class="line"><code class="plain">  issue_type LowCardinality(String),</code></div>
<div class="line"><code class="plain">  </code><code class="color2">year</code><code class="plain"> UInt16 MATERIALIZED toYear(started),</code></div>
<div class="line"><code class="plain">  </code><code class="color2">month</code><code class="plain"> UInt16 MATERIALIZED toMonth(started),</code></div>
<div class="line"><code class="plain">  dayno UInt8 MATERIALIZED toDayOfMonth(started)</code></div>
<div class="line"><code class="plain">) ENGINE = MergeTree()</code></div>
<div class="line"><code class="keyword">ORDER</code><code class="plain"> </code><code class="keyword">BY</code><code class="plain"> id;</code></div>
</div>
    </div>
<p   
>When a Confluence field is added to OLAP cube then a matching column is created in the table, for example:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="keyword">create</code><code class="plain"> </code><code class="keyword">table</code><code class="plain"> jira_worklog (</code></div>
<div class="line"><code class="plain">  ...</code></div>
<div class="line"><code class="plain">  cf_11100 LowCardinality(String)</code></div>
<div class="line"><code class="plain">  ...</code></div>
</div>
    </div>
<p   
>For every Jira worklog record the Confluence Fields plugin will create a matching record (or a set of records) in jira_worklog table. The operation is batched: it may take a minute or so for a worklog to get propagated to ClickHouse.</p>
    </div>
    <div class="section section-1" id="src-58753059_ConfluenceFieldsOLAP-Mondrian">
        <h1 class="heading "><span>Mondrian</span></h1>
<p   
>Mondrian is an OLAP engine written in Java. It executes MDX-queries, reading data from ClickHouse database, and presents the results in a multidimensional format via a Java API.</p>
<p   
>The easiest way to run Mondrian is to use the <a  class="external-link" href="https://hub.docker.com/repository/docker/mesilat/mondrian-clickhouse">docker image</a>. The image is based on Mondrian community version and a builtin ClickHouse JDBC driver. Alternatively you may choose <a  class="external-link" href="https://github.com/SergeiSemenkov/eMondrian">eMondrian</a> web archive (WAR) to run in your Tomcat or other Java application server.</p>
<p   
>With docker-compose your mondrian service definition can be as follows:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">mondrian:</code></div>
<div class="line"><code class="plain">  restart: unless-stopped</code></div>
<div class="line"><code class="plain">  image: mesilat/mondrian-clickhouse</code></div>
<div class="line"><code class="plain">  container_name: mondrian</code></div>
<div class="line"><code class="plain">  network_mode: host</code></div>
<div class="line"><code class="plain">  environment:</code></div>
<div class="line"><code class="plain">    JAVA_OPTS: -Xms4096m -Xmx4096m</code></div>
<div class="line"><code class="plain">  volumes:</code></div>
<div class="line"><code class="plain">    - /var/docker/demo/xmla/webapps:/usr/local/tomcat/webapps</code></div>
<div class="line"><code class="plain">    - /var/docker/demo/xmla/logs:/usr/local/tomcat/logs</code></div>
</div>
    </div>
<p   
>There are two configuration files that need to be fixed to get your Mondrian server to run Jira worklog cube: <strong class=" ">datasources.xml</strong> and <strong class=" ">JiraWorklog.xml</strong></p>
<p   
>datasources.xml (full path is /usr/local/tomcat/webapps/mondrian/WEB-INF/datasources.xml) defines ClickHouse database connection settings and your schema catalog:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;?</code><code class="keyword">xml</code><code class="plain"> </code><code class="color1">version</code><code class="plain">=</code><code class="string">"1.0"</code><code class="plain">?&gt;</code></div>
<div class="line"><code class="plain">&lt;</code><code class="keyword">DataSources</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">DataSource</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">DataSourceName</code><code class="plain">&gt;JiraWorklog&lt;/</code><code class="keyword">DataSourceName</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">DataSourceDescription</code><code class="plain">&gt;Jira Worklog&lt;/</code><code class="keyword">DataSourceDescription</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">URL</code><code class="plain">&gt;</code><code class="comments">http://localhost:8080/emondrian/xmla</code><code class="plain">&lt;/</code><code class="keyword">URL</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">DataSourceInfo</code><code class="plain">&gt;Provider=mondrian;Jdbc=jdbc:</code><code class="comments">clickhouse://clickhouse:8123;JdbcDrivers=ru.yandex.clickhouse.ClickHouseDriver</code><code class="plain">&lt;/</code><code class="keyword">DataSourceInfo</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">ProviderName</code><code class="plain">&gt;Mondrian&lt;/</code><code class="keyword">ProviderName</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">ProviderType</code><code class="plain">&gt;MDP&lt;/</code><code class="keyword">ProviderType</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">AuthenticationMode</code><code class="plain">&gt;Unauthenticated&lt;/</code><code class="keyword">AuthenticationMode</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">Catalogs</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;</code><code class="keyword">Catalog</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Jira"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">Definition</code><code class="plain">&gt;/WEB-INF/schema/JiraWorklog.xml&lt;/</code><code class="keyword">Definition</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;/</code><code class="keyword">Catalog</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">Catalogs</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;/</code><code class="keyword">DataSource</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">&lt;/</code><code class="keyword">DataSources</code><code class="plain">&gt;</code></div>
</div>
    </div>
<p   
>JiraWorklog.xml (full path is /usr/local/tomcat/webapps/mondrian/WEB-INF/schema/JiraWorklog.xml) is a schema definition file that should match your Confluence Fields OLAP setup.</p>
<p   
>You can download a proper schema file from Jira Confluence Fields OLAP settings page:</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-10.31.30.png" alt="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-10.31.30.png"   />
The following schema file is for reference only:</p>
    <div  class="confbox programlisting" style="counter-reset: scroll-code-numbering 1">
                <div xmlns="http://www.w3.org/1999/xhtml" class="defaultnew syntaxhighlighter scroll-html-formatted-code" data-linenumbers="false" data-firstline="1">
<div class="line"><code class="plain">&lt;?</code><code class="keyword">xml</code><code class="plain"> </code><code class="color1">version</code><code class="plain">=</code><code class="string">"1.0"</code><code class="plain">?&gt;</code></div>
<div class="line"><code class="plain">&lt;</code><code class="keyword">Schema</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"JiraWorklog"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">  &lt;</code><code class="keyword">Cube</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"JiraWorklog"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">Table</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"jira_worklog"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">Dimension</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Date"</code><code class="plain"> </code><code class="color1">type</code><code class="plain">=</code><code class="string">"TimeDimension"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;</code><code class="keyword">Hierarchy</code><code class="plain"> </code><code class="color1">hasAll</code><code class="plain">=</code><code class="string">"true"</code><code class="plain"> </code><code class="color1">allMemberName</code><code class="plain">=</code><code class="string">"All Dates"</code><code class="plain"> </code><code class="color1">primaryKey</code><code class="plain">=</code><code class="string">"started"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">Level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Year"</code><code class="plain"> </code><code class="color1">column</code><code class="plain">=</code><code class="string">"year"</code><code class="plain"> </code><code class="color1">uniqueMembers</code><code class="plain">=</code><code class="string">"true"</code><code class="plain"> </code><code class="color1">levelType</code><code class="plain">=</code><code class="string">"TimeYears"</code><code class="plain"> </code><code class="color1">type</code><code class="plain">=</code><code class="string">"Numeric"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">Level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Month"</code><code class="plain"> </code><code class="color1">column</code><code class="plain">=</code><code class="string">"month"</code><code class="plain"> </code><code class="color1">uniqueMembers</code><code class="plain">=</code><code class="string">"false"</code><code class="plain"> </code><code class="color1">ordinalColumn</code><code class="plain">=</code><code class="string">"month"</code><code class="plain"> </code><code class="color1">levelType</code><code class="plain">=</code><code class="string">"TimeMonths"</code><code class="plain"> </code><code class="color1">type</code><code class="plain">=</code><code class="string">"Numeric"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">          &lt;</code><code class="keyword">CaptionExpression</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">            &lt;</code><code class="keyword">SQL</code><code class="plain"> </code><code class="color1">dialect</code><code class="plain">=</code><code class="string">"generic"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">              CASE month WHEN 1 THEN 'January'</code></div>
<div class="line"><code class="plain">              WHEN 2 THEN 'February'</code></div>
<div class="line"><code class="plain">              WHEN 3 THEN 'March'</code></div>
<div class="line"><code class="plain">              WHEN 4 THEN 'April'</code></div>
<div class="line"><code class="plain">              WHEN 5 THEN 'May'</code></div>
<div class="line"><code class="plain">              WHEN 6 THEN 'June'</code></div>
<div class="line"><code class="plain">              WHEN 7 THEN 'July'</code></div>
<div class="line"><code class="plain">              WHEN 8 THEN 'August'</code></div>
<div class="line"><code class="plain">              WHEN 9 THEN 'September'</code></div>
<div class="line"><code class="plain">              WHEN 10 THEN 'October'</code></div>
<div class="line"><code class="plain">              WHEN 11 THEN 'November'</code></div>
<div class="line"><code class="plain">              WHEN 12 THEN 'December'</code></div>
<div class="line"><code class="plain">              ELSE 'Unknown' END</code></div>
<div class="line"><code class="plain">            &lt;/</code><code class="keyword">SQL</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">          &lt;/</code><code class="keyword">CaptionExpression</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;/</code><code class="keyword">Level</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">Level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Day"</code><code class="plain"> </code><code class="color1">column</code><code class="plain">=</code><code class="string">"dayno"</code><code class="plain"> </code><code class="color1">uniqueMembers</code><code class="plain">=</code><code class="string">"false"</code><code class="plain"> </code><code class="color1">ordinalColumn</code><code class="plain">=</code><code class="string">"dayno"</code><code class="plain"> </code><code class="color1">nameColumn</code><code class="plain">=</code><code class="string">"started"</code><code class="plain"> </code><code class="color1">levelType</code><code class="plain">=</code><code class="string">"TimeDays"</code><code class="plain"> </code><code class="color1">type</code><code class="plain">=</code><code class="string">"Numeric"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;/</code><code class="keyword">Hierarchy</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">Dimension</code><code class="plain">&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">Dimension</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Worker"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;</code><code class="keyword">Hierarchy</code><code class="plain"> </code><code class="color1">hasAll</code><code class="plain">=</code><code class="string">"true"</code><code class="plain"> </code><code class="color1">allMemberName</code><code class="plain">=</code><code class="string">"All Workers"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">Level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"User Name"</code><code class="plain"> </code><code class="color1">column</code><code class="plain">=</code><code class="string">"worker"</code><code class="plain"> </code><code class="color1">uniqueMembers</code><code class="plain">=</code><code class="string">"true"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">      &lt;/</code><code class="keyword">Hierarchy</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">Dimension</code><code class="plain">&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">Dimension</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Jira Issue"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;</code><code class="keyword">Hierarchy</code><code class="plain"> </code><code class="color1">hasAll</code><code class="plain">=</code><code class="string">"true"</code><code class="plain"> </code><code class="color1">allMemberName</code><code class="plain">=</code><code class="string">"All Issues"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">Level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Project"</code><code class="plain"> </code><code class="color1">column</code><code class="plain">=</code><code class="string">"project_key"</code><code class="plain"> </code><code class="color1">uniqueMembers</code><code class="plain">=</code><code class="string">"true"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">Level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Issue"</code><code class="plain"> </code><code class="color1">column</code><code class="plain">=</code><code class="string">"issue_key"</code><code class="plain"> </code><code class="color1">uniqueMembers</code><code class="plain">=</code><code class="string">"true"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">      &lt;/</code><code class="keyword">Hierarchy</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">Dimension</code><code class="plain">&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">Dimension</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Issue Type"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;</code><code class="keyword">Hierarchy</code><code class="plain"> </code><code class="color1">hasAll</code><code class="plain">=</code><code class="string">"true"</code><code class="plain"> </code><code class="color1">allMemberName</code><code class="plain">=</code><code class="string">"All Issue Types"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">Level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Type Name"</code><code class="plain"> </code><code class="color1">column</code><code class="plain">=</code><code class="string">"issue_type"</code><code class="plain"> </code><code class="color1">uniqueMembers</code><code class="plain">=</code><code class="string">"true"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">      &lt;/</code><code class="keyword">Hierarchy</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">Dimension</code><code class="plain">&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">Dimension</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Client"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">      &lt;</code><code class="keyword">Hierarchy</code><code class="plain"> </code><code class="color1">hasAll</code><code class="plain">=</code><code class="string">"true"</code><code class="plain"> </code><code class="color1">allMemberName</code><code class="plain">=</code><code class="string">"All"</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">        &lt;</code><code class="keyword">Level</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Client Name"</code><code class="plain"> </code><code class="color1">column</code><code class="plain">=</code><code class="string">"cf_11100"</code><code class="plain"> </code><code class="color1">uniqueMembers</code><code class="plain">=</code><code class="string">"true"</code><code class="plain"> /&gt;</code></div>
<div class="line"><code class="plain">      &lt;/</code><code class="keyword">Hierarchy</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">    &lt;/</code><code class="keyword">Dimension</code><code class="plain">&gt;</code></div>
<div class="line"> </div>
<div class="line"><code class="plain">    &lt;</code><code class="keyword">Measure</code><code class="plain"> </code><code class="color1">name</code><code class="plain">=</code><code class="string">"Time Spent"</code><code class="plain"> </code><code class="color1">column</code><code class="plain">=</code><code class="string">"timespent"</code><code class="plain"> </code><code class="color1">aggregator</code><code class="plain">=</code><code class="string">"sum"</code><code class="plain"> </code><code class="color1">formatString</code><code class="plain">=</code><code class="string">"#,###"</code><code class="plain">/&gt;</code></div>
<div class="line"><code class="plain">  &lt;/</code><code class="keyword">Cube</code><code class="plain">&gt;</code></div>
<div class="line"><code class="plain">&lt;/</code><code class="keyword">Schema</code><code class="plain">&gt;</code></div>
</div>
    </div>
    </div>
    <div class="section section-1" id="src-58753059_ConfluenceFieldsOLAP-MSExcel">
        <h1 class="heading "><span>MS Excel</span></h1>
<p   
>You need MS Excel for Windows to connect to your Mondrian server. Unfortunately using analytical services is not supported by MS Excel for Mac.</p>
<p   
>Hint: I use <a  class="external-link" href="https://www.virtualbox.org">VirtualBox</a> to run MS Excel for Windows on Mac</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-11.50.09.png" alt="images/wiki/download/attachments/58753059/Screenshot-2021-03-12-at-11.50.09.png"   />
    </p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot_2021-03-12_at_10.51.16.png" alt="images/wiki/download/attachments/58753059/Screenshot_2021-03-12_at_10.51.16.png"   />
<img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot_2021-03-12_at_10.51.53.png" alt="images/wiki/download/attachments/58753059/Screenshot_2021-03-12_at_10.51.53.png"   />
</p>
<p   
>By clicking Next several times you will end up with Jira worklog pivot in Excel:</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot_2021-03-12_at_10.52.13.png" alt="images/wiki/download/attachments/58753059/Screenshot_2021-03-12_at_10.52.13.png"   />
Some demo screenshots below. The demo is derived from Atlassian DC performance test dataset thus the obfuscated user names. The <strong class=" ">Time Spent</strong> measure is in hours.</p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot_2021-03-12_at_10.53.11.png" alt="images/wiki/download/attachments/58753059/Screenshot_2021-03-12_at_10.53.11.png"   />
    </p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot_2021-03-12_at_10.59.18.png" alt="images/wiki/download/attachments/58753059/Screenshot_2021-03-12_at_10.59.18.png"   />
    </p>
<p   
><img  class="confluence-embedded-image image-center"                 style="display:block; margin-left: auto; margin-right: auto;"
     src="images/wiki/download/attachments/58753059/Screenshot_2021-03-12_at_11.55.49.png" alt="images/wiki/download/attachments/58753059/Screenshot_2021-03-12_at_11.55.49.png"   />
    </p>
<p   
>Finally, here is a full docker setup for my demo site: <a   href="attachments_58753082_1_docker-compose.yml">docker-compose.yml</a></p>
<p   
></p>
    </div>
        </div>

    </article>


            <nav id="ht-post-nav">
                <a href="51151254.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Troubleshooting Confluence Fields plugin</span>
        </a>
                <a href="44696003.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2"
                          sketch:type="MSShapeGroup"
                          transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Weekly Activity Gadget</span>
        </a>
    </nav>    
            
    <footer id="ht-footer">
    <a href="#" id="ht-jump-top" class="sp-aui-icon-small sp-aui-iconfont-arrows-up"></a>
</footer></div>

<div>
    <div id="ht-mq-detect"></div>
</div>

    <script src="js/lunr.js"></script>
    <script src="js/lunr-extras.js"></script>
    <script src="assets/js/scroll-search.js"></script>

    <script src="assets/js/expand-macro.js"></script>
</body>
</html>
